{
  <%# Form: VBA 21P-0537 - Marital Status Questionnaire %>
  <%# Generated: 2025-09-22 %>
  <%# Maps JSON payload for VBA form 21P-0537 to PDF form fields %>

  <%# Page 1 - Letter/Cover Page %>

  <%# In Reply Refer To field %>
  "form1[0].Page1[0].InReply[0]": "<%= form.data['inReplyReferTo'] %>",

  <%# Regional Office Director Signature - left blank (signature field for VA office use) %>
  "form1[0].Page1[0].Signature[0]": "",

  <%# Page 2 - Marital Status Questionnaire %>

  <%# Question 1A: Have you remarried since the death of the veteran? %>
  "form1[0].Page2[0].RadioButtonList[0]": "<%= form.data['hasRemarried'] ? 'YES' : 'NO' %>",

  <% if form.data['hasRemarried'] %>
    <%# 1B. Date of Marriage (only if remarried) %>
    "form1[0].Page2[0].DOBmonth[0]": "<%= form.data.dig('remarriage', 'dateOfMarriage', 'month') %>",
    "form1[0].Page2[0].DOBday[0]": "<%= form.data.dig('remarriage', 'dateOfMarriage', 'day') %>",
    "form1[0].Page2[0].DOByear[0]": "<%= form.data.dig('remarriage', 'dateOfMarriage', 'year') %>",

    <%# 1C. Name of Spouse (if remarried) - respect max lengths %>
    "form1[0].Page2[0].VeteransLastName[0]": "<%= form.data.dig('remarriage', 'spouseName', 'last')&.[](0..17) %>",
    "form1[0].Page2[0].VeteransMiddleInitial1[0]": "<%= form.data.dig('remarriage', 'spouseName', 'middle')&.[](0) %>",
    "form1[0].Page2[0].VeteransFirstName[0]": "<%= form.data.dig('remarriage', 'spouseName', 'first')&.[](0..11) %>",

    <%# 1D. Spouse Date of Birth %>
    "form1[0].Page2[0].DOBmonth[3]": "<%= form.data.dig('remarriage', 'spouseDateOfBirth', 'month') %>",
    "form1[0].Page2[0].DOBday[2]": "<%= form.data.dig('remarriage', 'spouseDateOfBirth', 'day') %>",
    "form1[0].Page2[0].DOByear[2]": "<%= form.data.dig('remarriage', 'spouseDateOfBirth', 'year') %>",

    <%# 1E. Is your spouse a veteran? %>
    "form1[0].Page2[0].RadioButtonList[1]": "<%= form.data.dig('remarriage', 'spouseIsVeteran') ? 'YES' : 'NO' %>",

    <% if form.data.dig('remarriage', 'spouseIsVeteran') %>
      <%# 1F. If "YES," provide your new spouse's VA File Number or Social Security Number %>
      <% if form.data.dig('remarriage', 'spouseVAFileNumber').present? %>
        <%# VA File Number (max 9 digits) %>
        "form1[0].Page2[0].VAFileNumber[0]": "<%= form.data.dig('remarriage', 'spouseVAFileNumber')&.[](0..8) %>",
      <% else %>
        <%# OR Social Security Number %>
        "form1[0].Page2[0].VeteransSocialSecurityNumber_FirstThreeNumbers[0]": "<%= form.data.dig('remarriage', 'spouseSSN', 'first3') %>",
        "form1[0].Page2[0].VeteransSocialSecurityNumber_SecondTwoNumbers[0]": "<%= form.data.dig('remarriage', 'spouseSSN', 'middle2') %>",
        "form1[0].Page2[0].VeteransSocialSecurityNumber_LastFourNumbers[0]": "<%= form.data.dig('remarriage', 'spouseSSN', 'last4') %>",
      <% end %>
    <% else %>
      <%# Leave VA File Number and SSN fields empty if spouse is not a veteran %>
      "form1[0].Page2[0].VAFileNumber[0]": "",
      "form1[0].Page2[0].VeteransSocialSecurityNumber_FirstThreeNumbers[0]": "",
      "form1[0].Page2[0].VeteransSocialSecurityNumber_SecondTwoNumbers[0]": "",
      "form1[0].Page2[0].VeteransSocialSecurityNumber_LastFourNumbers[0]": "",
    <% end %>

    <%# 1G. What was your age at the time of your marriage? (max 2 digits) %>
    "form1[0].Page2[0].DOBmonth[1]": "<%= form.data.dig('remarriage', 'ageAtMarriage')&.[](0..1) %>",

    <%# 2A. Has your remarriage been terminated? %>
    "form1[0].Page2[0].RadioButtonList[2]": "<%= form.data.dig('remarriage', 'hasTerminated') ? 'YES' : 'NO' %>",

    <% if form.data.dig('remarriage', 'hasTerminated') %>
      <%# 2B. Date of Termination (only if terminated) %>
      "form1[0].Page2[0].DOBmonth[2]": "<%= form.data.dig('remarriage', 'terminationDate', 'month') %>",
      "form1[0].Page2[0].DOBday[1]": "<%= form.data.dig('remarriage', 'terminationDate', 'day') %>",
      "form1[0].Page2[0].DOByear[1]": "<%= form.data.dig('remarriage', 'terminationDate', 'year') %>",

      <%# 2C. Reason for Termination %>
      "form1[0].Page2[0].TERMINATION_REASON[0]": "<%= form.data.dig('remarriage', 'terminationReason') %>",
    <% else %>
      <%# Leave termination fields empty if not terminated %>
      "form1[0].Page2[0].DOBmonth[2]": "",
      "form1[0].Page2[0].DOBday[1]": "",
      "form1[0].Page2[0].DOByear[1]": "",
      "form1[0].Page2[0].TERMINATION_REASON[0]": "",
    <% end %>
  <% else %>
    <%# If not remarried, leave all remarriage-related fields empty %>
    "form1[0].Page2[0].DOBmonth[0]": "",
    "form1[0].Page2[0].DOBday[0]": "",
    "form1[0].Page2[0].DOByear[0]": "",
    "form1[0].Page2[0].VeteransLastName[0]": "",
    "form1[0].Page2[0].VeteransMiddleInitial1[0]": "",
    "form1[0].Page2[0].VeteransFirstName[0]": "",
    "form1[0].Page2[0].DOBmonth[3]": "",
    "form1[0].Page2[0].DOBday[2]": "",
    "form1[0].Page2[0].DOByear[2]": "",
    "form1[0].Page2[0].RadioButtonList[1]": "Off",
    "form1[0].Page2[0].VAFileNumber[0]": "",
    "form1[0].Page2[0].VeteransSocialSecurityNumber_FirstThreeNumbers[0]": "",
    "form1[0].Page2[0].VeteransSocialSecurityNumber_SecondTwoNumbers[0]": "",
    "form1[0].Page2[0].VeteransSocialSecurityNumber_LastFourNumbers[0]": "",
    "form1[0].Page2[0].DOBmonth[1]": "",
    "form1[0].Page2[0].RadioButtonList[2]": "Off",
    "form1[0].Page2[0].DOBmonth[2]": "",
    "form1[0].Page2[0].DOBday[1]": "",
    "form1[0].Page2[0].DOByear[1]": "",
    "form1[0].Page2[0].TERMINATION_REASON[0]": "",
  <% end %>

  <%# 3A. Daytime Telephone Number (always populate) %>
  "form1[0].Page2[0].Daytime1[0]": "<%= form.data.dig('recipient', 'phone', 'daytime', 'areaCode') %>",
  "form1[0].Page2[0].Daytime2[0]": "<%= form.data.dig('recipient', 'phone', 'daytime', 'prefix') %>",
  "form1[0].Page2[0].Daytime3[0]": "<%= form.data.dig('recipient', 'phone', 'daytime', 'lineNumber') %>",

  <%# 3B. Evening Telephone Number (always populate) %>
  "form1[0].Page2[0].Daytime1[1]": "<%= form.data.dig('recipient', 'phone', 'evening', 'areaCode') %>",
  "form1[0].Page2[0].Daytime2[1]": "<%= form.data.dig('recipient', 'phone', 'evening', 'prefix') %>",
  "form1[0].Page2[0].Daytime3[1]": "<%= form.data.dig('recipient', 'phone', 'evening', 'lineNumber') %>",

  <%# 4. E-Mail Address (max 30 characters) %>
  "form1[0].Page2[0].VeteransLastName[1]": "<%= form.data.dig('recipient', 'email')&.[](0..29) %>",

  <%# 5A. Signature %>
  "form1[0].Page2[0].Signature[0]": "<%= form.data.dig('recipient', 'signature') %>",

  <%# 5B. Date Signed - using form.signature_date like the examples %>
  "form1[0].Page2[0].DOBmonth[4]": "<%= form.signature_date&.strftime('%m') %>",
  "form1[0].Page2[0].DOBday[3]": "<%= form.signature_date&.strftime('%d') %>",
  "form1[0].Page2[0].DOByear[3]": "<%= form.signature_date&.strftime('%Y') %>"
}