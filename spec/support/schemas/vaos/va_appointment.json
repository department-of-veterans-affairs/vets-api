{
  "$schema" : "http://json-schema.org/draft-04/schema#",
  "type": "object",
  "required": ["id", "type", "attributes"],
  "properties": {
    "id": { "type": "string" },
    "type": { "type": "string", "enum": ["va_appointments"] },
    "attributes": {
      "type": "object",
      "anyOf": [
        {
          "required": [
            "start_date",
            "clinic_id",
            "facility_id",
            "community_care",
            "vds_appointments"
          ]
        },
        {
          "required": [
            "start_date",
            "clinic_id",
            "facility_id",
            "community_care",
            "vvs_appointments"
          ]
        }
      ],
      "properties": {
        "start_date": { "type": "string", "format": "date-time" },
        "clinic_id": { "type": "string" },
        "facility_id": { "type": "string" },
        "community_care": { "type": "boolean" },
        "vds_appointments": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "object",
            "required": [
              "appointment_length",
              "appointment_time",
              "clinic",
              "type",
              "current_status",
              "booking_note"
            ],
            "properties": {
              "appointment_length": { "type": "string" },
              "appointment_time": { "type": "string", "format": "date-time" },
              "clinic": {
                "type": "object",
                "required": ["name", "ask_for_check_in", "facility_code"],
                "properties": {
                  "name": { "type": "string" },
                  "ask_for_check_in": { "type": "boolean" },
                  "facility_code": { "type": "string" }
                }
              },
              "type": { "type": "string" },
              "current_status": { "type": "string" },
              "booking_note": { "type": "string" }
            }
          }
        },
        "vvs_appointments": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "object",
            "required": [
              "id",
              "appointment_kind",
              "source_system",
              "date_time",
              "desired_date",
              "duration",
              "status",
              "type",
              "booking_notes",
              "instructions_other",
              "patients",
              "providers"
            ],
            "properties": {
              "id": { "type": "string" },
              "appointment_kind": { "type": "string" },
              "source_system": { "type": "string" },
              "date_time": { "type": "string", "format": "date-time" },
              "desired_date": { "type": "string", "format": "date-time" },
              "duration": { "type": "integer" },
              "status": {
                "type": "object",
                "required": ["description", "code"],
                "properties": {
                  "description": { "type": "string" },
                  "code": { "type": "string" }
                }
              },
              "type": { "type": "string" },
              "booking_notes": { "type": "string" },
              "instructions_other": { "type": "boolean" },
              "patients": {
                "type": "array",
                "minItems": 1,
                "uniqueItems": true,
                "items": {
                  "$ref": "patient.json"
                }
              },
              "providers": {
                "type": "array",
                "minItems": 1,
                "uniqueItems": true,
                "items": {
                  "$ref": "provider.json"
                }
              }
            }
          }
        }
      }
    }
  }
}
